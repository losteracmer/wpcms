<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!-- Tell the browser to be responsive to screen width -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<!-- Favicon icon -->
	<link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon.png">
	<title>沁园净水机客户管理系统</title>
	<!-- This page CSS -->
	<link href="assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.css" rel="stylesheet">
	<link href="./assets/libs/toastr/build/toastr.min.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="assets/libs/select2/dist/css/select2.min.css">
	<link rel="stylesheet" type="text/css" href="assets/libs/bootstrap-switch/dist/css/bootstrap3/bootstrap-switch.min.css">
	<!-- Custom CSS -->
	<link href="dist/css/style.min.css" rel="stylesheet">
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
	<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	
<![endif]-->
	<style>
		.event::after{
				content: attr(data-etitle);
			}
		</style>
</head>

<body>
	<!-- ============================================================== -->
	<!-- Preloader - style you can find in spinners.css -->
	<!-- ============================================================== -->
	<div class="preloader">
		<div class="lds-ripple">
			<div class="lds-pos"></div>
			<div class="lds-pos"></div>
		</div>
	</div>
	<!-- ============================================================== -->
	<!-- Main wrapper - style you can find in pages.scss -->
	<!-- ============================================================== -->
	<div id="main-wrapper">
		<!-- ============================================================== -->
		<!-- Topbar header - style you can find in pages.scss -->
		<!-- ============================================================== -->
		<header class="topbar">
			<nav class="navbar top-navbar navbar-expand-md navbar-dark">
				<div class="navbar-header">
					<!-- This is for the sidebar toggle which is visible on mobile only -->
					<a class="nav-toggler waves-effect waves-light d-block d-md-none" href="javascript:void(0)">
						<i class="ti-menu ti-close"></i>
					</a>
					<!-- ============================================================== -->
					<!-- Logo -->
					<!-- ============================================================== -->
					<div class="navbar-brand">
						<a href="index.html" class="logo">
							<!-- Logo icon -->
							<b class="logo-icon">
								<!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
								<!-- Dark Logo icon -->
								<img src="assets/images/logo-icon.png" alt="homepage" class="dark-logo" />
								<!-- Light Logo icon -->
								<img src="assets/images/logo-light-icon.png" alt="homepage" class="light-logo" />
							</b>
							<!--End Logo icon -->
							<!-- Logo text -->
							<span class="logo-text">
								<!-- dark Logo text -->
								<img src="assets/images/logo-text.png" alt="homepage" class="dark-logo" />
								<!-- Light Logo text -->
								<img src="assets/images/logo-light-text.png" class="light-logo" alt="homepage" />
							</span>
						</a>
					</div>
					<!-- ============================================================== -->
					<!-- End Logo -->
					<!-- ============================================================== -->
					<!-- ============================================================== -->
					<!-- Toggle which is visible on mobile only -->
					<!-- ============================================================== -->
					<a class="topbartoggler d-block d-md-none waves-effect waves-light" href="javascript:void(0)" data-toggle="collapse"
					 data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<i class="ti-more"></i>
					</a>
				</div>
				<!-- ============================================================== -->
				<!-- End Logo -->
				<!-- ============================================================== -->
				<div class="navbar-collapse collapse" id="navbarSupportedContent">
					<!-- ============================================================== -->
					<!-- toggle and nav items -->
					<!-- ============================================================== -->
					<ul class="navbar-nav float-left mr-auto">
						<!-- <li class="nav-item d-none d-md-block">
                            <a class="nav-link sidebartoggler waves-effect waves-light" href="javascript:void(0)" data-sidebartype="mini-sidebar">
                                <i class="mdi mdi-menu font-24"></i>
                            </a>
                        </li> -->
						<!-- ============================================================== -->
						<!-- Search -->
						<!-- ============================================================== -->
						<li class="nav-item search-box">
							<a class="nav-link waves-effect waves-dark" href="javascript:void(0)">
								<div class="d-flex align-items-center">
									<i class="mdi mdi-magnify font-20 mr-1"></i>
									<div class="ml-1 d-none d-sm-block">
										<span>Search</span>
									</div>
								</div>
							</a>
							<form class="app-search position-absolute">
								<input type="text" class="form-control" placeholder="这个功能还没开发哦~~~~">
								<a class="srh-btn">
									<i class="ti-close"></i>
								</a>
							</form>
						</li>
					</ul>
					<!-- ============================================================== -->
					<!-- Right side toggle and nav items -->
					<!-- ============================================================== -->
					<ul class="navbar-nav float-right">
						<!-- ============================================================== -->
						<!-- Messages -->
						<!-- ============================================================== -->
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle waves-effect waves-dark" href="" id="2" data-toggle="dropdown" aria-haspopup="true"
							 aria-expanded="false">
								<i class="font-22 mdi mdi-email-outline"></i>

							</a>
							<div class="dropdown-menu dropdown-menu-right mailbox animated bounceInDown" aria-labelledby="2">
								<span class="with-arrow">
									<span class="bg-danger"></span>
								</span>
								<ul class="list-style-none">
									<li>
										<div class="drop-title text-white bg-danger">
											<h4 class="m-b-0 m-t-5">2新消息</h4>
											<span class="font-light">信息内容</span>
										</div>
									</li>
									<li>
										<div class="message-center message-body">
											<!-- Message -->
											<a href="javascript:void(0)" class="message-item">
												<span class="user-img">
													<img src="assets/images/users/1.jpg" alt="user" class="rounded-circle">
													<span class="profile-status online pull-right"></span>
												</span>
												<div class="mail-contnet">
													<h5 class="message-title">员工小王</h5>
													<span class="mail-desc">永阳花苑发水了，飞流直下，无法控制</span>
													<span class="time">9:30 AM</span>
												</div>
											</a>
											<!-- Message -->
											<a href="javascript:void(0)" class="message-item">
												<span class="user-img">
													<img src="assets/images/users/2.jpg" alt="user" class="rounded-circle">
													<span class="profile-status busy pull-right"></span>
												</span>
												<div class="mail-contnet">
													<h5 class="message-title">管理员</h5>
													<span class="mail-desc">老板，新机器有大牛5000￥购买30台，卖否？</span>
													<span class="time">19:10 AM</span>
												</div>
											</a>
										</div>
									</li>
									<li>
										<a class="nav-link text-center link text-dark" href="javascript:void(0);">
											<b>开发中~~~QAQ</b>
											<i class="fa fa-angle-right"></i>
										</a>
									</li>
								</ul>
							</div>
						</li>
						<!-- ============================================================== -->
						<!-- End Messages -->
						<!-- ============================================================== -->
						<!-- ============================================================== -->
						<!-- Comment -->
						<!-- ============================================================== -->
						<li class="nav-item dropdown border-right">
							<a class="nav-link dropdown-toggle waves-effect waves-dark" href="" data-toggle="dropdown" aria-haspopup="true"
							 aria-expanded="false">
								<i class="mdi mdi-bell-outline font-22"></i>
								<span class="badge badge-pill badge-info noti"></span>
							</a>
							<div class="dropdown-menu dropdown-menu-right mailbox animated bounceInDown">
								<span class="with-arrow">
									<span class="bg-primary"></span>
								</span>
								<ul class="list-style-none">
									<li>
										<div class="drop-title bg-primary text-white">
											<h4 class="m-b-0 m-t-5">4 New</h4>
											<span class="font-light">提醒</span>
										</div>
									</li>
									<li>
										<div class="message-center notifications">
											<!-- Message -->
											<a href="javascript:void(0)" class="message-item">
												<span class="btn btn-danger btn-circle">
													<i class="fa fa-link"></i>
												</span>
												<div class="mail-contnet">
													<h5 class="message-title">提示</h5>
													<span class="mail-desc">有位客户说今天给他换处理器</span>
													<span class="time">9:30 AM</span>
												</div>
											</a>
											<!-- Message -->
											<a href="javascript:void(0)" class="message-item">
												<span class="btn btn-success btn-circle">
													<i class="ti-calendar"></i>
												</span>
												<div class="mail-contnet">
													<h5 class="message-title">备忘</h5>
													<span class="mail-desc">明天放假，下班打卡别忘关灯</span>
													<span class="time">9:10 AM</span>
												</div>
											</a>

										</div>
									</li>
									<li>
										<a class="nav-link text-center m-b-5 text-dark" href="javascript:void(0);">
											<strong>开发中~~~QAQ</strong>
											<i class="fa fa-angle-right"></i>
										</a>
									</li>
								</ul>
							</div>
						</li>
						<!-- ============================================================== -->
						<!-- End Comment -->
						<!-- ============================================================== -->
						<!-- ============================================================== -->
						<!-- User profile and search -->
						<!-- ============================================================== -->
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle waves-effect waves-dark pro-pic" href="" data-toggle="dropdown" aria-haspopup="true"
							 aria-expanded="false">
								<img id="adminAvatarUrl" src="assets/images/users/2.jpg" alt="user" class="rounded-circle" width="40">
								<span id="adminNickName" class="m-l-5 font-medium d-none d-sm-inline-block">loading... <i class="mdi mdi-chevron-down"></i></span>
							</a>
							<div class="dropdown-menu dropdown-menu-right user-dd animated flipInY">
								<span class="with-arrow">
									<span class="bg-primary"></span>
								</span>
								<div class="d-flex no-block align-items-center p-15 bg-primary text-white m-b-10">
									<div class="">
										<img id="adminAvatarUrl2" src="assets/images/users/2.jpg" alt="user" class="rounded-circle" width="60">
									</div>
									<div class="m-l-10">
										<h4 id="adminNickName2" class="m-b-0">loading...</h4>
										<p id="adminAccount" class=" m-b-0">loading...</p>
									</div>
								</div>
								<a class="dropdown-item" href="javascript:void(0)">
									<i class="ti-user m-r-5 m-l-5"></i> 我的描述</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="javascript:void(0)">
									<i class="ti-settings m-r-5 m-l-5"></i> 账户设置</a>
								<div class="dropdown-divider"></div>
								<a id="logoutBtn" class="dropdown-item" href="javascript:void(0)">
									<i class="fa fa-power-off m-r-5 m-l-5"></i> 退出登录</a>
								<div class="dropdown-divider"></div>
								<div class="p-l-30 p-10">
									<a href="javascript:void(0)" class="btn btn-sm btn-success btn-rounded">关于</a>
								</div>
							</div>
						</li>
						<!-- ============================================================== -->
						<!-- User profile and search -->
						<!-- ============================================================== -->
					</ul>
				</div>
			</nav>
		</header>
		<!-- ============================================================== -->
		<!-- End Topbar header -->
		<!-- ============================================================== -->
		<!-- ============================================================== -->
		<!-- Left Sidebar - style you can find in sidebar.scss  -->
		<!-- ============================================================== -->
		<aside class="left-sidebar">
			<!-- Sidebar scroll-->
			<div class="scroll-sidebar">
				<!-- Sidebar navigation-->
				<nav class="sidebar-nav">
					<ul id="sidebarnav">
						<!-- 导航栏template
							<script id="naviListTemplate" type="text/template">
								<%var navi_main = null;%>
								<%for(var i=0;i<naviList.length;i++){var item = naviList[i];%>
									
									<%if(navi_main == null){%>
										<%navi_main = item.navi_main_id;%>
										<li class="nav-small-cap"><i class="<%=item.navi_main_icon%>"></i> <span class="hide-menu"><%=item.navi_main_name%></span></li>
										<li class="sidebar-item">
											<a class="sidebar-link has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
													class="mdi mdi-av-timer"></i><span class="hide-menu"><%=item.navi_main_simple%> </span></a>
											<ul aria-expanded="false" class="collapse  first-level">
									<%}else if(navi_main == item.navi_main_id){%>
										<%navi_main = item.navi_main_id;%>
												<li class="sidebar-item">
													<a href="index.html" class="sidebar-link"><i class="<%=item.navi_son_icon%>"></i><span class="hide-menu"> <%=item.navi_son_name%>
														</span></a>
												</li>
									<%}else if(navi_main != item.navi_main_id){%>
										<%navi_main = item.navi_main_id;%>
											</ul>
										</li>
										<li class="nav-small-cap"><i class="<%=item.navi_main_icon%>"></i> <span class="hide-menu"><%=item.navi_main_name%></span></li>
										<li class="sidebar-item">
											<a class="sidebar-link has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
													class="mdi mdi-av-timer"></i><span class="hide-menu"><%=item.navi_main_simple%> </span></a>
											<ul aria-expanded="false" class="collapse  first-level">
									<%}%>
								<%}%>
									</ul>
								</li>
							</script> -->
						<!-- User Profile-->
						<li class="nav-small-cap"><i class="mdi mdi-dots-horizontal"></i> <span class="hide-menu">首页</span></li>
						<li class="sidebar-item">
							<a class="sidebar-link has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
								 class="mdi mdi-av-timer"></i><span class="hide-menu">首页 </span></a>
							<ul aria-expanded="false" class="collapse  first-level">
								<li class="sidebar-item">
									<a href="index.html" class="sidebar-link"><i class="mdi mdi-timer-off"></i><span class="hide-menu"> 客户维护
										</span></a>
								</li>
								<li class="sidebar-item">
									<a href="analysis.html" class="sidebar-link"><i class="mdi mdi-chart-line"></i><span class="hide-menu"> 销售分析
										</span></a>
								</li>
								<li class="sidebar-item">
									<a href="customer_maintain.html" class="sidebar-link"><i class="ti ti-pulse"></i><span class="hide-menu"> 更换周期
										</span></a>
								</li>
							</ul>
						</li>
						<li class="nav-small-cap"><i class="mdi mdi-dots-horizontal"></i> <span class="hide-menu">业务</span></li>
						<li class="sidebar-item">
							<a class="sidebar-link two-column has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
								 class="mdi mdi-inbox-arrow-down"></i><span class="hide-menu">订单 </span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item">
									<a href="create_order.html" class="sidebar-link"><i class="mdi mdi-cart-plus"></i><span class="hide-menu">
											创建订单
										</span></a>
								</li>
								<li class="sidebar-item">
									<a href="order_list.html" class="sidebar-link"><i class="mdi mdi-cart"></i><span class="hide-menu"> 查看订单
										</span></a>
								</li>
							</ul>
						</li>
						<li class="nav-small-cap"><i class="mdi mdi-dots-horizontal"></i> <span class="hide-menu">客户</span></li>
						<li class="sidebar-item">
							<a class="sidebar-link two-column has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
								 class="mdi mdi-account-network"></i><span class="hide-menu">客户 </span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item">
									<a href="customer_list.html" class="sidebar-link"><i class="mdi mdi-account-star-variant"></i><span class="hide-menu">
											客户管理
										</span></a>
								</li>
								<li class="sidebar-item">
									<a href="customer_detail.html" class="sidebar-link"><i class="mdi mdi-account-box"></i><span class="hide-menu">
											客户详情 </span></a>
								</li>
								<li class="sidebar-item">
									<a href="recover.html" class="sidebar-link"><i class="fas fa-arrow-circle-down"></i><span class="hide-menu">
											数据恢复 </span></a>
								</li>
							</ul>
						</li>
						<li class="nav-small-cap"><i class="mdi mdi-tune"></i> <span class="hide-menu">设备</span></li>
						<li class="sidebar-item">
							<a class="sidebar-link two-column has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
								 class="mdi mdi-codepen"></i><span class="hide-menu">设备管理 </span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item">
									<a href="machine.html" class="sidebar-link"><i class="mdi mdi-vector-triangle"></i><span class="hide-menu">
											净水机
										</span></a>
								</li>
							</ul>
						</li>
						<li class="nav-small-cap"><i class="mdi mdi-dots-horizontal"></i> <span class="hide-menu">员工</span></li>
						<li class="sidebar-item">
							<a class="sidebar-link two-column has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i
								 class="mdi mdi-bulletin-board"></i><span class="hide-menu">员工管理 </span></a>
							<ul aria-expanded="false" class="collapse first-level">
								<li class="sidebar-item">
									<a href="labour_list.html" class="sidebar-link"><i class="mdi mdi-svg"></i><span class="hide-menu"> 员工列表
										</span></a>
								</li>
								<li class="sidebar-item">
									<a href="labour_detail.html" class="sidebar-link"><i class="mdi mdi-chart-histogram"></i><span class="hide-menu">
											员工详情 </span></a>
								</li>
							</ul>
						</li>
					</ul>
				</nav>
				<!-- End Sidebar navigation -->
			</div>
			<!-- End Sidebar scroll-->
		</aside>
		<!-- End Left Sidebar - style you can find in sidebar.scss  -->
		<!-- ============================================================== -->
		<!-- ============================================================== -->
		<!-- Page wrapper  -->
		<!-- ============================================================== -->
		<div class="page-wrapper">

			<!-- ============================================================== -->
			<!-- Container fluid  -->
			<!-- ============================================================== -->
			<div class="container-fluid">
				<!-- ============================================================== -->
				<!-- Start Page Content -->
				<!-- ============================================================== -->
				<!-- basic table -->
				<div class="row">
					<div class="col-12">
						<div class="card">
							<div class="card-body">
								<div class="bt-switch card-title">
									<label for="validshow">只显示未过期客户: </label>
									<input id="validshow" type="checkbox" data-on-color="success" data-off-color="info" data-on-text="全部显示"
									 data-off-text="只显示以过期">
									<label for="allotshow">派工显示: </label>
									<input id="allotshow" type="checkbox" checked data-on-color="success" data-off-color="info" data-on-text="全部显示"
									 data-off-text="只显示已派工">
									<label for="lazyshow">只显示推迟客户: </label>
									<input id="lazyshow" type="checkbox" checked data-on-color="success" data-off-color="info" data-on-text="不显示"
									 data-off-text="显示">
								</div>
								<div>
									点击显示/隐藏列:
									<a href="#!" class="toggle-vis" data-column="0">星级</a> -
									<a href="#!" class="toggle-vis" data-column="1">区域</a> -
									<a href="#!" class="toggle-vis" data-column="2">机器型号</a> -
									<a href="#!" class="toggle-vis" data-column="3">滤芯型号</a> -
									<a href="#!" class="toggle-vis" data-column="4">最近更换</a> -
									<a href="#!" class="toggle-vis" data-column="5">有效期</a> -
									<a href="#!" class="toggle-vis" data-column="6">用户姓名</a> -
									<a href="#!" class="toggle-vis" data-column="7">联系方式</a> -
									<a href="#!" class="toggle-vis" data-column="8">地址</a> -
									<a href="#!" class="toggle-vis" data-column="9">派工</a> -
									<a href="#!" class="toggle-vis" data-column="10">操作</a> -

								</div>
								<div class="table-responsive">
									<table id="index_list_table" class="table table-striped table-bordered display table-hover">
										<!-- <thead>
												<tr>
													<th>星级</th>
													<th>区域</th>
													<th>机器型号</th>
													<th>滤芯型号</th>
													<th>上次更换时间</th>
													<th>有效日期</th>
													<th>客户姓名</th>
													<th>联系方式</th>
													<th>详细地址</th>
													<th>派工状态</th>
													<th class="hidden-print">操作</th>
												</tr>
											</thead> -->
										<tbody id="list_body">

										</tbody>

									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- ============================================================== -->
				<!-- End PAge Content -->
				<!-- ============================================================== -->
				<!-- ============================================================== -->
				<!-- Right sidebar -->
				<!-- ============================================================== -->
				<!-- .right-sidebar -->
				<!-- ============================================================== -->
				<!-- End Right sidebar -->
				<!-- ============================================================== -->
			</div>
			<!-- ============================================================== -->
			<!-- End Container fluid  -->




			<!-- ============================================================== -->
			<!-- Create Modal -->
			<div class="modal fade" id="choselabour" role="dialog" aria-labelledby="createModalLabel" aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<form id="choseLabourForm">
							<div class="modal-header">
								<h5 class="modal-title" id="createModalLabel"><i class="ti-marker-alt m-r-10"></i>选择用户</h5>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
							<div class="modal-body">
								<div class="form-group">
									<label for="firstName1">选择派工员工</label>
									<select name='labourId' id="choselabourselect" class="select2 custom-select form-control" style="width: 100%; height:36px;">

										<script id="labourListTemplate" type="text/template">
											<%for(var i=0;i<labourlist.length;i++){var item = labourlist[i];%>
												<option value="<%=item.labour_id%>"><%=item.labour_name%></option>
											<%}%>
										</script>
									</select>
								</div>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
								<button type="button" class="btn btn-success" onclick=setDistribution()><i class="ti-settings"></i> 确定</button>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal fade" id="delayremind" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<form>
							<div class="modal-header">
								<h5 class="modal-title" id="exampleModalLabel"><i class="mdi mdi-auto-fix m-r-10">设置延迟提醒</i></h5>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
							<div class="modal-body">
								<h6>设置了延迟提醒，将会在一定时间后才会出现在列表上</h6>
								<div class="card">
									<div class="card-body">
										<h4 class="card-title">延迟时间:</h4>
										<form class="m-t-20">
											<input id="delaytimeid" type="number" value="-1" name="delytime">
										</form>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
									<button type="button" class="btn btn-success" onclick=setDelayTime()><i class="fas fa-paper-plane" id="confirmDelay"></i>
										确定</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>

			<div class="modal fade" id="setFinishTime" role="dialog" aria-labelledby="SetFinishTimeModalLabel" aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<form>
							<div class="modal-header">
								<h5 class="modal-title" id="SetFinishTimeModalLabel"><i class="mdi mdi-auto-fix m-r-10">设置完成提醒</i></h5>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
							<div class="modal-body">
								<h6>手动设置完成时间，若不设置，则默认是今天</h6>
								<div class="card">
									<div class="card-body">
										<h4 class="card-title">完成时间:</h4>
										<form class="m-t-20">
											<input id="finishtimeid" type="date" value="-1" name="finishTime">
										</form>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
									<button type="button" class="btn btn-success" onclick=setFinishTime()><i class="fas fa-paper-plane" id="confirmfinish"></i>确定</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>






			<!-- ============================================================== -->
			<!-- footer -->
			<!-- ============================================================== -->
			<footer class="footer text-center">
				All Rights Reserved by losteracmer. Designed and Developed by
				<a href="#">sst</a>.
			</footer>
			<!-- ============================================================== -->
			<!-- End footer -->
			<!-- ============================================================== -->
		</div>
		<!-- ============================================================== -->
		<!-- End Page wrapper  -->
		<!-- ============================================================== -->
	</div>
	<!-- ============================================================== -->
	<!-- End Wrapper -->
	<!-- ============================================================== -->
	<!-- ============================================================== -->
	<!-- All Jquery -->
	<!-- ============================================================== -->
	<script src="assets/libs/jquery/dist/jquery.min.js"></script>

	<!-- Bootstrap tether Core JavaScript -->
	<script src="assets/libs/popper.js/dist/umd/popper.min.js"></script>
	<script src="assets/libs/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- apps -->
	<script src="dist/js/app.min.js"></script>
	<script src="dist/js/app.init.js"></script>
	<script src="dist/js/app-style-switcher.js"></script>
	<!-- slimscrollbar scrollbar JavaScript -->
	<script src="assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js"></script>
	<script src="assets/extra-libs/sparkline/sparkline.js"></script>
	<!--Wave Effects -->
	<script src="dist/js/waves.js"></script>
	<!--Menu sidebar -->
	<script src="dist/js/sidebarmenu.js"></script>
	<!--Custom JavaScript -->
	<script src="dist/js/custom.min.js"></script>
	<script src="assets/libs/toastr/build/toastr.min.js"></script>
	<!--This page plugins -->
	<script src="assets/extra-libs/DataTables/datatables.min.js"></script>
	<script src="assets/libs/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>
	<script src="assets/libs/select2/dist/js/select2.full.min.js"></script>
	<script src="assets/libs/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>
	<script src="dist/js/pages/datatable/datatable-advanced.init.js"></script>
	<script src="js/adminMsg.js"></script>
	<!-- start - This is for export functionality only -->
	<!-- <script src="https://cdn.datatables.net/buttons/1.5.1/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.5.1/js/buttons.flash.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.5.1/js/buttons.html5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.5.1/js/buttons.print.min.js"></script> -->

	<!--本地打印js -->
	<script src="assets/libs/print/buttons.flash.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/libs/print/buttons.html5.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/libs/print/buttons.print.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/libs/print/dataTables.buttons.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/libs/print/jszip.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/libs/print/pdfmake.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/libs/print/vfs_fonts.js" type="text/javascript" charset="utf-8"></script>




	<script src="./dist/js/template-web.js"></script>

	<script>
		var Gfesid = null;
		var Gindex_table = null;
		var Goption = {
			validshow: false,
			allotshow: true
		};

		function setDelayTime() {

			var delaytime = $("#delaytimeid").val();
			//alert(delaytime)
			var fesid = Gfesid;
			$.ajax({
				url: '/index/delayremind',
				data: {
					fesid: fesid,
					delaytime: delaytime
				},
				success: function (data, textStatus) {
					if (data.code == 200) {
						//alert(data.msg)
						$("#delayremind").modal("hide");
						toastr.success(data.msg);
						Gindex_table.ajax.reload();

					} else {
						toastr.error(data.msg);
					}
				},
				error: function (xhr, textStatus) {
					alert(JSON.stringify(xhr));
				}
			})

		}

		function setFinishTime() {

			var finishtime = $("#finishtimeid").val();
			//alert(delaytime)
			var fesid = Gfesid;
			$.ajax({
				url: '/index/finished',
				data: {
					fesid: fesid,
					finishtime,
					finishtime
				},
				success: function (data, textStatus) {
					if (data.code == 200) {
						toastr.success(data.msg);
						Gindex_table.ajax.reload();
						$("#setFinishTime").modal("hide");
					} else {
						toastr.warning(data.msg)
					}
				},
				error: function (error) {
					alert(error)
				}
			})

		}

		function setDistribution() {
			var choseLabourObj = $("#choseLabourForm").serialize();
			$.ajax({
				url: '/index/setlabour' + "?" + choseLabourObj,
				data: {
					fesid: Gfesid
				},
				success: function (data, textStatus) {
					if (data.code == 200) {
						toastr.success(data.msg);
						$("#choselabour").modal("hide");
						Gindex_table.ajax.reload();
					} else {
						toastr.error(data.msg);
					}

				},
				error: function (xhr, textStatus) {
					console.error(xhr)
				}
			})
		}

		function setEvent() {
			//console.log('设置事件');
			//console.log($(".dropdown-item"))
			$("a.event").off(); //清空所有事件...
			$("a[data-event='delay']").bind('click', function () {

				var fesid = $(this).parent().data('fesid');
				Gfesid = fesid;
				console.log("fesid: " + fesid);
				$("#delayremind").modal("show");
			})
			$("a[data-event='distribution']").bind('click', function () {

				var fesid = $(this).parent().data('fesid');
				Gfesid = fesid;
				console.log("fesid: " + fesid);
				$.ajax({
					url: '/labour/getlist',
					success: function (data, textStatus) {
						console.log('labour list 请求成功' + data);

						var lobourlistStr = template('labourListTemplate', data);
						$("#choselabourselect").html(lobourlistStr);
					},
					error: function (xhr, textStatus) {

					}
				})
				$("#choselabour").modal("show");
			})

			$("a[data-event='detail']").bind('click', function () {
				var fesid = $(this).parent().data('fesid');
				$.ajax({
					url: '/index/getcustomerid',
					data: {
						fesid: fesid
					},
					success: function (data, textStatus) {
						if (data.code == 200) {
							toastr.success('正在跳转...')
							window.location.href = '/customer_detail.html?customer_id=' + data.customer_id;
						} else {
							toastr.warning(data.msg)
						}
					},
					error: function (error) {
						alert(error)
					}
				})

			})
			$("a[data-event='finished']").bind('click', function () {
				var fesid = $(this).parent().data('fesid');
				Gfesid = fesid;
				$("#setFinishTime").modal("show");

			})
		}

		function createButton(id) {
			//console.log('渲染完成')
			return `<td class="hidden-print">
						<div class="btn-group">
							<button type="button" class="btn btn-dark dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick=setEvent()>
							<i class="ti-settings"></i>
						</button>
							<div data-fesid='${id}' class="dropdown-menu animated slideInUp" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 35px, 0px);">
								<a class="dropdown-item detail event" href="javascript:void(0)"  data-event='detail' data-etitle='客户详情'><i class='ti-eye'></i> </a>
								<a class="dropdown-item distribution event" href="javascript:void(0)"  data-event='distribution' data-etitle='派工'><i class="ti-pencil-alt"></i> </a>
								<a class="dropdown-item delayevent event" href="javascript:void(0)" data-event='delay' id='delayevent' data-etitle='推迟提醒'><i class="ti-na"></i> </a>
								<a class="dropdown-item finished event" href="javascript:void(0)" data-event='finished' id='finished' data-etitle='完成维修'><i class="ti-direction"></i> </a>
							</div>
						</div>
					</td>`
		};

		function TableInit() {



			Gindex_table = $("#index_list_table").DataTable({
				dom: 'Bfrtip',
				//columnDefs:[{"targets":[11],"visible":false}],
				// buttons: [
				// 	'copy', 'csv', 'excel', 'pdf', 'print'
				// ],
				"destroy": true,
				buttons: [{
					extend: 'print',
					text: '打印',
					exportOptions: {
						columns: [1, 2, 3, 4, 5, 6, 7, 8, 9]
						//visible:true
						//columns:$(".odd")
					}
				}, {
					extend: 'excel',
					text: '导出表格'
				}],
				ajax: {
					url: `/index/getlistajax?validshow=${Goption.validshow}&allotshow=${Goption.allotshow}`,

				},
				//data: data.list,
				oLanguage: {
					"sSearch": "搜索",
					"sProcessing": "正在获取数据，请稍后...",
					"sLengthMenu": "显示 _MENU_ 条",
					"sZeroRecords": "没有内容",
					"sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
					"sInfoEmpty": "记录数为0",
					"sInfoFiltered": "(全部记录数 _MAX_ 条)",
					"sInfoPostFix": "",
					"oPaginate": {
						"sFirst": "第一页",
						"sPrevious": "上一页",
						"sNext": "下一页",
						"sLast": "最后一页",

					}
				},
				columns: [{
						title: "星级",
						data: "customer_star"
					},
					{
						title: "区域",
						data: "customer_area"
					},
					{
						title: "机器型号",
						data: "machine_model"
					},
					{
						title: "滤芯型号",
						data: "fe_model"
					},
					{
						title: "最近更换",
						data: "last_time"
					},
					{
						title: "有效期",
						data: "valid_time"
					}, {
						title: "用户姓名",
						data: "real_name"
					}, {
						title: "联系方式",
						data: "mobile_1"
					}, {
						title: "地址",
						data: "address"
					}, {
						title: "派工",
						data: "labour_name"
					}, {
						title: '操作',
						data: 'festatus_id',
						render: (data, type, full) => {
							return createButton(data)
						}
					}
				]
			})
			$('.buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel').addClass(
				'btn btn-cyan text-white mr-1');
			//document.getElementById("list_body").innerHTML =lists;
			//index_list_table.rows.add(data.list);


		}
		$(document).ready(function () {

			$("#validshow").bootstrapSwitch({
				onSwitchChange: function (event, data) {
					console.log('switch change' + data);
					if (data) {
						$("#validshow").removeAttr("checked");
						Goption.validshow = true;
					} else {
						$("#validshow").attr("checked", "checked");
						Goption.validshow = false;
					}
					var allotshowStatus = $('#allotshow').attr('checked');
					//Gindex_table.ajax.data = Goption;
					//console.log('重新加载url；'+`/index/getlistajax?validshow=${Goption.validshow}&allotshow=${Goption.allotshow}`)
					Gindex_table.ajax.url(`/index/getlistajax?validshow=${Goption.validshow}&allotshow=${Goption.allotshow}`).load();


				}
			})

			$("#allotshow").bootstrapSwitch({
				onSwitchChange: function (event, data) {
					console.log('switch change' + data);
					if (data) {
						$("#allotshow").removeAttr("checked");
						Goption.allotshow = true;
					} else {
						$("#allotshow").attr("checked", "checked");
						Goption.allotshow = false;
					}
					var allotshowStatus = $('#allotshow').attr('checked');
					//Gindex_table.ajax.data = Goption;
					//console.log('重新加载url；'+`/index/getlistajax?validshow=${Goption.validshow}&allotshow=${Goption.allotshow}`)
					Gindex_table.ajax.url(`/index/getlistajax?validshow=${Goption.validshow}&allotshow=${Goption.allotshow}`).load();


				}
			})
			$("#lazyshow").bootstrapSwitch({
				onSwitchChange: function (event, data) {
					console.log('switch change' + data);
					if (data) {
						$("#lazyshow").removeAttr("checked");
						Goption.lazyshow = false;
					} else {
						$("#lazyshow").attr("checked", "checked");
						Goption.lazyshow = true;
					}
					var lazyshowStatus = $('#lazyshow').attr('checked');
					//Gindex_table.ajax.data = Goption;
					//console.log('重新加载url；'+`/index/getlistajax?validshow=${Goption.validshow}&lazyshow=${Goption.allotshow}`)
					Gindex_table.ajax.url(
						`/index/getlistajax?validshow=${Goption.validshow}&allotshow=${Goption.allotshow}&lazyshow=${Goption.lazyshow}`
					).load();


				}
			})
			var validshowStatus = $('#validshow').attr('checked');
			console.log(validshowStatus)

			TableInit({
				validshow: true,
				allotshow: true
			});
			$("input[name='delytime']").TouchSpin();
			var index_list_table = $("#index_list_table")


		})
	</script>

</body>

</html>